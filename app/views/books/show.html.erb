<% content_for :title, "#{@book.title} door #{human_list(@book.authors.pluck(:name))}" %>

<article class="detail">
  <header class="detail__header">
    <h1><%= @book.title %></h1>

    <%= tag.div @book.subtitle, class: "detail__subtitle" if @book.subtitle.present? %>
    <%= tag.div human_list_with_links(@book.authors), class: "detail__names" if @book.authors.any? %>
  </header>

  <aside class="detail__aside">
    <h2>Waar gaat het over?</h2>

    <div class="description">
      <% if @book.description.present? %>
        <%= simple_format(@book.description) %>
      <% else %>
        <p>Sorry, wij weten het niet! Er is helaas geen beschrijving beschikbaar.</p>
      <% end %>
    </div>

    <% if @book.separated_keywords.any? %>
      <h2 class="mt-8">Iets voor jou?</h2>

      <nav class="tags">
        <%= render partial: "keyword", collection: @book.separated_keywords, as: :keyword %>
      </nav>
    <% end %>

    <h2 class="mt-8">Nog wat extra's</h2>

    <div class="summary" role="complementary">
      <div class="summary__label" id="isbn">
        ISBN
      </div>

      <div class="summary__value" aria-labelledby="isbn">
        <%= @book.isbn %>
      </div>

      <% if @book.genres.any? %>
        <div class="summary__label" id="genres">
          Genres
        </div>

        <div class="summary__value" aria-labelledby="genres">
          <% @book.genres.each_with_index do |genre, index| %>
            <%= link_to genre.name, genre_path(genre), class: "genre" %>
            <%= tag.span ",&nbsp".html_safe if index + 1 < @book.genres.size %>
          <% end %>
        </div>
      <% end %>

      <div class="summary__label" id="language">
        Taal
      </div>

      <div class="summary__value" aria-labelledby="language">
        <% # TODO: Add proper translation keys %>
        <%= @book.language === "en" ? "Engels" : "Nederlands" %>
      </div>

      <div class="summary__label" id="format">
        Formaat
      </div>

      <div class="summary__value" aria-labelledby="format">
        <%= @book.format %>
      </div>

      <div class="summary__label" id="number_of_pages">
        Pagina's
      </div>

      <div class="summary__value" aria-labelledby="number_of_pages">
        <%= @book.formatted_number_of_pages %>
      </div>

      <% if @book.published_date_text %>
        <div class="summary__label" id="published_date">
          Uitgifte
        </div>

        <div class="summary__value" aria-labelledby="published_date">
          <%= @book.formatted_published_date %>
        </div>
      <% end %>
    </div>
  </aside>

  <figure class="detail__image cover" style="<%= "--aspect-ratio: #{@book.cover_aspect_ratio}" if @book.cover_aspect_ratio.present? %>">
    <% if @book.cover_image.attached? %>
      <%= image_tag @book.cover_image.variant(:large), width: 300, height: 475 %>
      <%= image_tag @book.cover_image.variant(:large), width: 300, height: 475, class: "cover__blur" %>
    <% else %>
      <div class="cover__empty">
        <%= inline_svg_tag "images/icons/icon-no-image.svg", width: 60, height: 60 %>
      </div>
    <% end %>
  </figure>

  <section class="detail__content">
    <div class="listings">
      <h2>Waar is het te vinden?</h2>

      <%= render @listings %>
    </div>

    <div class="detail__cutout"></div>
  </section>
</article>
